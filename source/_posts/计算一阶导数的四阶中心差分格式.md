---
title: 计算一阶导数的四阶中心差分格式
date: 2021-03-23 23:01:37
tags: [导数, 中心差分]
categories: 计算方法
mathjax: true
---

![四阶中心差分](四阶中心差分.png)

原理：利用指定点 $y_t$ 周围的四个点$(y_{t-2}, y_{t-1}, y_{t+2},y_{t+2})$构造 **拉格朗日插值曲线**

<!--more-->
$$
\begin{aligned}
y(x) =& y_{t-2}\frac{(x-x_{t-1})(x-x_{t+1})(x-x_{t+2})}{(x_{t-2}-x_{t-1})(x_{t-2}-x_{t+1})(x_{t-2}-x_{t+2})} \\
\\
&+y_{t-1}\frac{(x-x_{t-2})(x-x_{t+1})(x-x_{t+2})}{(x_{t-1}-x_{t-2})(x_{t-1}-x_{t+1})(x_{t-1}-x_{t+2})} \\
\\
&+y_{t+1}\frac{(x-x_{t-2})(x-x_{t-1})(x-x_{t+2})}{(x_{t+1}-x_{t-2})(x_{t+1}-x_{t-1})(x_{t+1}-x_{t+2})} \\
\\
&+y_{t+2}\frac{(x-x_{t-2})(x-x_{t-1})(x-x_{t+1})}{(x_{t+2}-x_{t-2})(x_{t+2}-x_{t-1})(x_{t+2}-x_{t+1})}
\end{aligned}
$$

分母是可以直接写出来的，记 $h \equiv x_t - x_{t-1}$ 为自变量间隔：
$$
\begin{aligned}
y(x) =& y_{t-2}\frac{(x-x_{t-1})(x-x_{t+1})(x-x_{t+2})}{(-h)(-3h)(-4h)} \\\\
&+y_{t-1}\frac{(x-x_{t-2})(x-x_{t+1})(x-x_{t+2})}{(h)(-2h)(-3h)} \\
\\
&+y_{t+1}\frac{(x-x_{t-2})(x-x_{t-1})(x-x_{t+2})}{(3h)(2h)(-h)} \\
\\
&+y_{t+2}\frac{(x-x_{t-2})(x-x_{t-1})(x-x_{t+1})}{(4h)(3h)(h)} \\\\
=&[  -y_{t-2}(x-x_{t-1})(x-x_{t+1})(x-x_{t+2})\\
& + 2y_{t-1}(x-x_{t-2})(x-x_{t+1})(x-x_{t+2})\\
& -2y_{t+1}(x-x_{t-2})(x-x_{t-1})(x-x_{t+2})\\
& + y_{t+2}(x-x_{t-2})(x-x_{t-1})(x-x_{t+1})  ]\frac{1}{12h^3} 
\end{aligned}
$$

接下来就是求该三次函数在 $x_t$ 处的导数 $y'(x_{t})$
$$
\begin{aligned}
y'(x) =& \{  -y_{t-2}[(x-x_{t+1})(x-x_{t+2})+(x-x_{t-1})(x-x_{t+2})+(x-x_{t-1})(x-x_{t+1})]\\
\\
& + 2y_{t-1}[(x-x_{t+1})(x-x_{t+2})+(x-x_{t-2})(x-x_{t+2})+(x-x_{t-2})(x-x_{t+1})]\\
\\
& -2y_{t+1}[(x-x_{t-1})(x-x_{t+2})+(x-x_{t-2})(x-x_{t+2})+(x-x_{t-2})(x-x_{t-1})]\\
\\
& + y_{t+2}[(x-x_{t-1})(x-x_{t+1})+(x-x_{t-2})(x-x_{t+1})+(x-x_{t-2})(x-x_{t-1})] \}\frac{1}{12h^3} 
\end{aligned}
$$
所以
$$
\begin{aligned}
y'(x_t) =& \{  -y_{t-2}[(x_t-x_{t+1})(x_t-x_{t+2})+(x_t-x_{t-1})(x_t-x_{t+2})+(x_t-x_{t-1})(x_t-x_{t+1})]\\
\\
& + 2y_{t-1}[(x_t-x_{t+1})(x_t-x_{t+2})+(x_t-x_{t-2})(x_t-x_{t+2})+(x_t-x_{t-2})(x_t-x_{t+1})]\\
\\
& -2y_{t+1}[(x_t-x_{t-1})(x_t-x_{t+2})+(x_t-x_{t-2})(x_t-x_{t+2})+(x_t-x_{t-2})(x_t-x_{t-1})]\\
\\
& + y_{t+2}[(x_t-x_{t-1})(x_t-x_{t+1})+(x_t-x_{t-2})(x_t-x_{t+1})+(x_t-x_{t-2})(x_t-x_{t-1})] \}\frac{1}{12h^3} \\
\\
=&  \{  -y_{t-2}[(-h)(-2h)+(h)(-2h)+(h)(-h)]\\
\\
& + 2y_{t-1}[(-h)(-2h)+(2h)(-2h)+(2h)(-h)]\\
\\
& -2y_{t+1}[(h)(-2h)+(2h)(-2h)+(2h)(h)]\\
\\
& + y_{t+2}[(h)(-h)+(2h)(-h)+(2h)(h)] \}\frac{1}{12h^3} \\
\\
=&  (  y_{t-2}  -8y_{t-1} +8y_{t+1}- y_{t+2} )\frac{1}{12h} \\
\end{aligned}
$$

这就是计算一阶导数的四阶中心差分格式！
